jQuery.extend({handleError:function(a,c,d,b){a.error&&a.error.call(a.context||a,c,d,b);a.global&&(a.context?jQuery(a.context):jQuery.event).trigger("ajaxError",[c,a,b])},createUploadIframe:function(a,c){var d="jUploadFrame"+a;if(window.ActiveXObject)if("9.0"==jQuery.browser.version)b=document.createElement("iframe"),b.id=d,b.name=d;else{if("6.0"==jQuery.browser.version||"7.0"==jQuery.browser.version||"8.0"==jQuery.browser.version){var b=document.createElement('<iframe id="'+d+'" name="'+d+'" />');"boolean"==typeof c?b.src="javascript:false":"string"==typeof c&&(b.src=c)}}else b=document.createElement("iframe"),b.id=d,b.name=d;b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";document.body.appendChild(b);return b},ajaxUpload:function(a,c){var d=(new Date).getTime(),b="jUploadFrame"+d,f=this,h=$('<iframe name="'+b+'" id="'+b+'" style="display:none">').appendTo("body"),g=$('<form action="'+a.url+'" target="'+b+'" method="post" enctype="multipart/form-data"></form>').appendTo("body"),b=$("#"+a.fileElementId),l=$(b).clone();$(b).attr("id","jUploadFile"+d);$(b).before(l);$(b).appendTo(g);this.remove=function(){null!==f&&(jNewFile.before(jOldFile).remove(),h.remove(),g.remove(),f=null)};this.onLoad=function(){var b=$(h[0].contentWindow.document.body).text();try{if(void 0!=b){try{a.success&&a.success(b,status),a.global&&jQuery.event.trigger("ajaxSuccess",[c,a]),a.complete&&a.complete(b,status),c=null}catch(d){status="error",jQuery.handleError(a,c,status,d)}a.global&&jQuery.event.trigger("ajaxComplete",[c,a]);a.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop")}}catch(d){alert(d.message)}};this.start=function(){g.submit();h.load(f.onLoad)};return this},createUploadForm:function(a,c,d,b){var f="jUploadForm"+a;a="jUploadFile"+a;c=jQuery('<form  action="'+c+'" method="POST" name="'+f+'" id="'+f+'" enctype="multipart/form-data"></form>');if(b)for(var h in b)jQuery('<input type="hidden" name="'+h+'" value="'+b[h]+'" />').appendTo(c);d=jQuery("#"+d);b=jQuery(d).clone();jQuery(d).attr("id",a);jQuery(d).before(b);jQuery(d).appendTo(c);jQuery(c).css("position","absolute");jQuery(c).css("top","-1200px");jQuery(c).css("left","-1200px");jQuery(c).appendTo("body");return c},ajaxFileupload:function(a){var c={};a=jQuery.extend({},jQuery.ajaxSettings,a);if(window.ActiveXObject)(new jQuery.ajaxUpload(a,c)).start();else{var d=(new Date).getTime(),b=jQuery.createUploadForm(d,a.url,a.fileElementId,"undefined"==typeof a.data?!1:a.data);jQuery.createUploadIframe(d,a.secureuri);var f="jUploadFrame"+d,d="jUploadForm"+d;a.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var h=!1;a.global&&jQuery.event.trigger("ajaxSend",[c,a]);var g=function(d){var e=document.getElementById(f);try{e.contentWindow?(c.responseText=e.contentWindow.document.body?e.contentWindow.document.body.innerHTML:null,c.responseXML=e.contentWindow.document.XMLDocument?e.contentWindow.document.XMLDocument:e.contentWindow.document):e.contentDocument&&(c.responseText=e.contentDocument.document.body?e.contentDocument.document.body.innerHTML:null,c.responseXML=e.contentDocument.document.XMLDocument?e.contentDocument.document.XMLDocument:e.contentDocument.document)}catch(g){jQuery.handleError(a,c,null,g)}if(c||"timeout"==d){h=!0;var k;try{if(k="timeout"!=d?"success":"error","error"!=k){var m=jQuery.uploadHttpData(c,a.dataType);a.success&&a.success(m,k);a.global&&jQuery.event.trigger("ajaxSuccess",[c,a]);a.complete&&a.complete(m,k)}else jQuery.handleError(a,c,k)}catch(g){jQuery.handleError(a,c,"error",g)}a.global&&jQuery.event.trigger("ajaxComplete",[c,a]);a.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop");jQuery(e).unbind();setTimeout(function(){try{jQuery(e).remove(),jQuery(b).remove()}catch(d){jQuery.handleError(a,c,null,d)}},100);c=null}};0<a.timeout&&setTimeout(function(){h||g("timeout")},a.timeout);try{b=jQuery("#"+d),jQuery(b).attr("action",a.url),jQuery(b).attr("method","POST"),jQuery(b).attr("target",f),b.encoding?jQuery(b).attr("encoding","multipart/form-data"):jQuery(b).attr("enctype","multipart/form-data"),jQuery(b).submit()}catch(l){jQuery.handleError(a,c,null,l)}jQuery("#"+f).load(g);return{abort:function(){}}}},uploadHttpData:function(a,c){return a.responseText}});